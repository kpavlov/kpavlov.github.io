<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Json on The Culture of Code</title>
    <link>https://konstantinpavlov.net/tags/json/index.xml</link>
    <description>Recent content in Json on The Culture of Code</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="https://konstantinpavlov.net/tags/json/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>JSON Validation with JSON Schema</title>
      <link>https://konstantinpavlov.net/blog/2014/05/10/json-validation-with-json-schema/</link>
      <pubDate>Sat, 10 May 2014 15:48:12 +0300</pubDate>
      
      <guid>https://konstantinpavlov.net/blog/2014/05/10/json-validation-with-json-schema/</guid>
      <description>&lt;p&gt;JSON has became a de-facto standard for webservices, replacing XML web services.
It has native support in web browser clients.&lt;/p&gt;

&lt;p&gt;That makes JSON is the standard of choice for UI-oriented services.
It has a good support on mobile devices.
Also, it provides smaller data payload size compared to XML and it&amp;rsquo;s very sufficient for high-load systems as it saves a traffic.
But what is for data validation?
For XML web services there is a XML Schema.
It comes ti mind, that similar standard for JSON should be called &lt;a href=&#34;http://json-schema.org/&#34; target=&#34;_blank&#34;&gt;&amp;laquo;JSON Schema&amp;raquo;&lt;/a&gt;.
And it really exists!&lt;/p&gt;

&lt;p&gt;
There are a number of &lt;a href=&#34;http://json-schema.org/implementations.html&#34; target=&#34;_blank&#34;&gt;libraries&lt;/a&gt; for working with JSON Schema, including validators, documentation generators and data processing.&lt;/p&gt;

&lt;p&gt;For java, there is a library which implements JSON message validation: &lt;a href=&#34;https://github.com/fge/json-schema-validator&#34; target=&#34;_blank&#34;&gt;json-schema-validator&lt;/a&gt;.
It uses &lt;a href=&#34;https://github.com/FasterXML/jackson&#34; target=&#34;_blank&#34;&gt;jackson&lt;/a&gt; library as its&amp;rsquo; core and can be used in any java environment.&lt;/p&gt;

&lt;p&gt;Here is demo application project: &lt;a href=&#34;https://github.com/fge/json-schema-validator-demo&#34; target=&#34;_blank&#34;&gt;json-schema-validator-demo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Code sample:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.fasterxml.jackson.databind.JsonNode;
import com.github.fge.jsonschema.main.JsonValidator;
import com.github.fge.jsonschema.main.JsonSchemaFactory;
import com.github.fge.jsonschema.core.report.ProcessingReport;
import com.github.fge.jsonschema.core.util.AsJson;
...

JsonValidator VALIDATOR  = JsonSchemaFactory.byDefault().getValidator();

JsonNode schemaNode = ...
JsonNode data = ...

ProcessingReport report = VALIDATOR.validateUnchecked(schemaNode, data);

final boolean success = report.isSuccess();

final JsonNode reportAsJson = ((AsJson) report).asJson();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Demo applicaiton: &lt;a href=&#34;https://json-schema-validator.herokuapp.com/&#34; target=&#34;_blank&#34;&gt;https://json-schema-validator.herokuapp.com/&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Java-protobuf-format: Easy Protobuf-to-JSON Serialization in Java</title>
      <link>https://konstantinpavlov.net/blog/2012/04/22/java-protobuf-format-easy-protobuf-to-json-serialization-in-java/</link>
      <pubDate>Sun, 22 Apr 2012 13:09:42 +0000</pubDate>
      
      <guid>https://konstantinpavlov.net/blog/2012/04/22/java-protobuf-format-easy-protobuf-to-json-serialization-in-java/</guid>
      <description>&lt;p&gt;If you need Google Protobuf-to-JSON serialization (and vice versa) there is quick solution.
&lt;a href=&#34;http://code.google.com/p/protobuf-java-format/&#34; target=&#34;_blank&#34;&gt;Protobuf-java-format&lt;/a&gt; library provides serialization of protobuf-generated java classes to number of formats: JSON, XML, HTML, Java property file format, Smile, CoachDB.&lt;/p&gt;

&lt;p&gt;Here is a step-by-step instruction.

Configure maven protobuf compiler plugin and dependency in your maven&amp;rsquo;s &lt;em&gt;pom.xml&lt;/em&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;properties&amp;gt;
    &amp;lt;!-- You may need to specify path to protobuf compiler --&amp;gt;
    &amp;lt;protocCommand&amp;gt;/opt/local/bin/protoc&amp;lt;/protocCommand&amp;gt;
&amp;lt;/properties&amp;gt;

&amp;lt;build&amp;gt;
    &amp;lt;plugins&amp;gt;
        &amp;lt;plugin&amp;gt;
            &amp;lt;groupId&amp;gt;com.github.igor-petruk.protobuf&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;protobuf-maven-plugin&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;0.5.1&amp;lt;/version&amp;gt;
            &amp;lt;executions&amp;gt;
                &amp;lt;execution&amp;gt;
                    &amp;lt;goals&amp;gt;
                        &amp;lt;goal&amp;gt;run&amp;lt;/goal&amp;gt;
                    &amp;lt;/goals&amp;gt;
                &amp;lt;/execution&amp;gt;
            &amp;lt;/executions&amp;gt;
        &amp;lt;/plugin&amp;gt;
    &amp;lt;/plugins&amp;gt;
&amp;lt;/build&amp;gt;

&amp;lt;dependencies&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;com.google.protobuf&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;protobuf-java&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;2.4.1&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Add the protobuf-java-format dependency to your maven project (&lt;em&gt;pom.xml&lt;/em&gt;):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;...
&amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;com.googlecode.protobuf-java-format&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;protobuf-java-format&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;1.2&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Create protobuf definition in &lt;code&gt;/src/main/protobuf/test.proto&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-protobuf&#34;&gt;package example;
option java_multiple_files = true;
option java_outer_classname = &amp;quot;Messages&amp;quot;;

message Person {
    required string name = 1;
    required Gender gender = 2;
    optional sint32 age = 3;

    enum Gender {
        MALE = 1;
        FEMALE = 2;
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you may serialize and deserialize your Protobuf java objects:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Person person = Person.newBuilder()
        .setName(&amp;quot;Bob&amp;quot;)
        .setAge(10)
        .setGender(Person.Gender.MALE)
        .build();

System.out.println(&amp;quot;Original=[&amp;quot; + person + &amp;quot;]&amp;quot;);
String jsonView = com.googlecode.protobuf.format.JsonFormat.printToString(person);

System.out.println(&amp;quot;JSON=&#39;&amp;quot; + jsonView + &amp;quot;&#39;&amp;quot;);

Person.Builder personBuilder = Person.newBuilder();
com.googlecode.protobuf.format.JsonFormat.merge(jsonView, personBuilder);

Person person2 = personBuilder.build();
System.out.println(&amp;quot;Deserialized=[&amp;quot; + person2 + &amp;quot;]&amp;quot;);
System.out.println(&amp;quot;Original.equals.Deserialized=&amp;quot; + person.equals(person2));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This code will produce following output:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-text&#34;&gt;Original=[name: &amp;quot;Bob&amp;quot;
        gender: MALE
        age: 10
        ]
        JSON=&#39;{&amp;quot;name&amp;quot;: &amp;quot;Bob&amp;quot;,&amp;quot;gender&amp;quot;: &amp;quot;MALE&amp;quot;,&amp;quot;age&amp;quot;: 10}&#39;
Deserialized=[name: &amp;quot;Bob&amp;quot;
        gender: MALE
        age: 10
        ]
Original.equals.Deserialized=true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;http://code.google.com/p/protobuf-java-format/&#34; target=&#34;_blank&#34;&gt;Protobuf-java-format&lt;/a&gt; uses proto object metadata (&lt;code&gt;message.getAllFields()&lt;/code&gt;) under the hood.
So, it maybe not a fastest solution and not optimized for mobile devices (sometimes it is not always desirable to include metadata into generated proto-classes to be used on mobile devices).
Though, itâ€™s easy to implement&amp;hellip;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>